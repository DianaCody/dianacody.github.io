<!doctype html>



  


<html class="theme-next mist use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Camera Calibration," />





  <link rel="alternate" href="/atom.xml" title="DianaCody" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="相机标定的目标是获取相机内外参、imu参数、几者间的转换矩阵参数，标定工具Kalibr。">
<meta property="og:type" content="article">
<meta property="og:title" content="相机标定">
<meta property="og:url" content="http://www.dianacody.com/2022/12/01/2022-12-01-Calib/index.html">
<meta property="og:site_name" content="DianaCody">
<meta property="og:description" content="相机标定的目标是获取相机内外参、imu参数、几者间的转换矩阵参数，标定工具Kalibr。">
<meta property="og:image" content="http://www.dianacody.com/resources/calib-reprojection-error-stereo.jpg">
<meta property="og:image" content="http://www.dianacody.com/resources/calib-reprojection-error-stereo-imu.jpg">
<meta property="og:updated_time" content="2023-08-03T12:14:46.722Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="相机标定">
<meta name="twitter:description" content="相机标定的目标是获取相机内外参、imu参数、几者间的转换矩阵参数，标定工具Kalibr。">
<meta name="twitter:image" content="http://www.dianacody.com/resources/calib-reprojection-error-stereo.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'DianaCody'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.dianacody.com/2022/12/01/2022-12-01-Calib/"/>





  <title> 相机标定 | DianaCody </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?401273a24c3ce73d59b8b4083481a0be";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">DianaCody</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">subtitle,subtitle,subtitle</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
            About
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.dianacody.com/2022/12/01/2022-12-01-Calib/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DianaCody">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/psb.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DianaCody">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                相机标定
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-12-01T00:00:00+08:00">
                2022-12-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Camera-Calibration/" itemprop="url" rel="index">
                    <span itemprop="name">Camera Calibration</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          
              <div class="post-description">
                  相机标定的目标是获取相机内外参、imu参数、几者间的转换矩阵参数，标定工具Kalibr。
              </div>
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h5 id="一、概述"><a href="#一、概述" class="headerlink" title="一、概述"></a>一、概述</h5><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;相机标定的目标是获取双目相机参数、imu参数、几者之间的转换矩阵参数。标定的主要工作包括：<br>1.获取双目相机内参+双目转换矩阵；<br>2.获取imu参数，以测定噪声密度、随机游走；<br>3.双目+imu联合标定，获取双目到imu的转换矩阵；</p>
<h5 id="二、相机参数说明"><a href="#二、相机参数说明" class="headerlink" title="二、相机参数说明"></a>二、相机参数说明</h5><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;相机参数配置文件camchain.yaml，存储相机内外参的校准、IMU相对于相机的空间/时间校准参数。其所含的参数说明如下：<br><strong>· CAMERA_MODEL</strong>：camera_model(pin_hole/omni)，(针孔/全向)。<br><strong>· intrinsics</strong>：包含给定投影类型的内部参数的向量。要素如下：</p>
<ul>
<li>pinhone: [fu fv pu pv]</li>
<li>omni: [xi fu fv pu pv]</li>
<li>ds: [xi alpha fu fv pu pv]</li>
<li>eucm: [alpha beta fu fv pu pv]</li>
</ul>
<p><strong>· distortion_model</strong>：畸变模型，(radtan/equidistant)。<br><strong>· distortion_coeffs</strong>：畸变参数。<br><strong>· T_cn_cnm1</strong>：相机外在转换，总是相对于链中最后一个相机。（例如：cam1：T_cn_cnm1 = T_c1_c0，将cam0转换为cam1坐标）<br><strong>· T_cam_imu</strong>：imu外参，从imu到相机坐标的转换(T_c_i)。<br><strong>· timeshift_cam_imu</strong>：相机和imu时间戳之间的时间间隔，以秒为单位（t_imu = t_cam + shift）。<br><strong>· rostopic</strong>：摄像机图像流的主题。<br><strong>· resolution</strong>：相机分辨率[width,height]。</p>
<p>示例：</p>
<h6 id="1-相机chain-yaml"><a href="#1-相机chain-yaml" class="headerlink" title="1.相机chain.yaml"></a>1.相机chain.yaml</h6><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="attr">cam0:</span></div><div class="line"><span class="attr">  camera_model:</span> <span class="string">pinhole</span></div><div class="line"><span class="attr">  intrinsics:</span> <span class="string">[461.629,</span> <span class="number">460.152</span><span class="string">,</span> <span class="number">362.680</span><span class="string">,</span> <span class="number">246.049</span><span class="string">]</span></div><div class="line"><span class="attr">  distortion_model:</span> <span class="string">radtan</span></div><div class="line"><span class="attr">  distortion_coeffs:</span> <span class="string">[-0.27695497,</span> <span class="number">0.06712482</span><span class="string">,</span> <span class="number">0.00087538</span><span class="string">,</span> <span class="number">0.00011556</span><span class="string">]</span></div><div class="line"><span class="attr">  T_cam_imu:</span></div><div class="line"><span class="bullet">  -</span> <span class="string">[0.01779318,</span> <span class="number">0.99967549</span><span class="string">,-0.01822936,</span> <span class="number">0.07008565</span><span class="string">]</span></div><div class="line"><span class="bullet">  -</span> <span class="string">[-0.9998017,</span> <span class="number">0.01795239</span><span class="string">,</span> <span class="number">0.00860714</span><span class="string">,-0.01771023]</span></div><div class="line"><span class="bullet">  -</span> <span class="string">[0.00893160,</span> <span class="number">0.01807260</span><span class="string">,</span> <span class="number">0.99979678</span><span class="string">,</span> <span class="number">0.00399246</span><span class="string">]</span></div><div class="line"><span class="bullet">  -</span> <span class="string">[0.0,</span> <span class="number">0.0</span><span class="string">,</span> <span class="number">0.0</span><span class="string">,</span> <span class="number">1.0</span><span class="string">]</span></div><div class="line"><span class="attr">  timeshift_cam_imu:</span> <span class="bullet">-8.121e-05</span></div><div class="line"><span class="attr">  rostopic:</span> <span class="string">/cam0/image_raw</span></div><div class="line"><span class="attr">  resolution:</span> <span class="string">[752,</span> <span class="number">480</span><span class="string">]</span></div><div class="line"><span class="attr">cam1:</span></div><div class="line"><span class="attr">  camera_model:</span> <span class="string">omni</span></div><div class="line"><span class="attr">  intrinsics:</span> <span class="string">[0.80065662,</span> <span class="number">833.006</span><span class="string">,</span> <span class="number">830.345</span><span class="string">,</span> <span class="number">373.850</span><span class="string">,</span> <span class="number">253.749</span><span class="string">]</span></div><div class="line"><span class="attr">  distortion_model:</span> <span class="string">radtan</span></div><div class="line"><span class="attr">  distortion_coeffs:</span> <span class="string">[-0.33518750,</span> <span class="number">0.13211436</span><span class="string">,</span> <span class="number">0.00055967</span><span class="string">,</span> <span class="number">0.00057686</span><span class="string">]</span></div><div class="line"><span class="attr">  T_cn_cnm1:</span></div><div class="line"><span class="bullet">  -</span> <span class="string">[</span> <span class="number">0.99998854</span><span class="string">,</span> <span class="number">0.00216014</span><span class="string">,</span> <span class="number">0.00427195</span><span class="string">,-0.11003785]</span></div><div class="line"><span class="bullet">  -</span> <span class="string">[-0.00221074,</span> <span class="number">0.99992702</span><span class="string">,</span> <span class="number">0.01187697</span><span class="string">,</span> <span class="number">0.00045792</span><span class="string">]</span></div><div class="line"><span class="bullet">  -</span> <span class="string">[-0.00424598,-0.01188627,</span> <span class="number">0.99992034</span><span class="string">,-0.00064487]</span></div><div class="line"><span class="bullet">  -</span> <span class="string">[0.0,</span> <span class="number">0.0</span><span class="string">,</span> <span class="number">0.0</span><span class="string">,</span> <span class="number">1.0</span><span class="string">]</span></div><div class="line"><span class="attr">  T_cam_imu:</span></div><div class="line"><span class="bullet">  -</span> <span class="string">[</span> <span class="number">0.01567142</span><span class="string">,</span> <span class="number">0.99978002</span><span class="string">,-0.01393948,-0.03997419]</span></div><div class="line"><span class="bullet">  -</span> <span class="string">[-0.99966203,</span> <span class="number">0.01595569</span><span class="string">,</span> <span class="number">0.02052137</span><span class="string">,-0.01735854]</span></div><div class="line"><span class="bullet">  -</span> <span class="string">[</span> <span class="number">0.02073927</span><span class="string">,</span> <span class="number">0.01361317</span><span class="string">,</span> <span class="number">0.99969223</span><span class="string">,</span> <span class="number">0.00326019</span><span class="string">]</span></div><div class="line"><span class="bullet">  -</span> <span class="string">[0.0,</span> <span class="number">0.0</span><span class="string">,</span> <span class="number">0.0</span><span class="string">,</span> <span class="number">1.0</span><span class="string">]</span></div><div class="line"><span class="attr">  timeshift_cam_imu:</span> <span class="bullet">-8.681e-05</span></div><div class="line"><span class="attr">  rostopic:</span> <span class="string">/cam1/image_raw</span></div><div class="line"><span class="attr">  resolution:</span> <span class="string">[752,</span> <span class="number">480</span><span class="string">]</span></div></pre></td></tr></table></figure>
<h6 id="2-imu配置：imu-yaml"><a href="#2-imu配置：imu-yaml" class="headerlink" title="2.imu配置：imu.yaml"></a>2.imu配置：imu.yaml</h6><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#Accelerometers</span></div><div class="line"><span class="attr">accelerometer_noise_density:</span> <span class="number">1.86e-03</span>   <span class="comment">#Noise density (continuous-time)</span></div><div class="line"><span class="attr">accelerometer_random_walk:</span>   <span class="number">4.33e-04</span>   <span class="comment">#Bias random walk</span></div><div class="line"></div><div class="line"><span class="comment">#Gyroscopes</span></div><div class="line"><span class="attr">gyroscope_noise_density:</span>     <span class="number">1.87e-04</span>   <span class="comment">#Noise density (continuous-time)</span></div><div class="line"><span class="attr">gyroscope_random_walk:</span>       <span class="number">2.66e-05</span>   <span class="comment">#Bias random walk</span></div><div class="line"></div><div class="line"><span class="attr">rostopic:</span>                    <span class="string">/imu0</span>      <span class="comment">#the IMU ROS topic</span></div><div class="line"><span class="attr">update_rate:</span>                 <span class="number">200.0</span>      <span class="comment">#Hz (for discretization of the values above)</span></div></pre></td></tr></table></figure>
<h5 id="三、标定环境搭建"><a href="#三、标定环境搭建" class="headerlink" title="三、标定环境搭建"></a>三、标定环境搭建</h5><h6 id="1-ros安装"><a href="#1-ros安装" class="headerlink" title="1.ros安装"></a><strong>1.ros安装</strong></h6><p>注意当前匹配使用的ubuntu系统版本。<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">1.[添加软件源=aliyun]  <span class="comment"># ubuntu 18.04 &amp; 20.04</span></div><div class="line">sudo sh -c <span class="string">'echo "deb http://packages.ros.org/ros/ubuntu $(lsb_release -sc) main" &gt; /etc/apt/sources.list.d/ros-latest.list'</span></div><div class="line">sudo sh -c <span class="string">'. /etc/lsb-release &amp;&amp; echo "deb http://mirrors.ustc.edu.cn/ros/ubuntu/ $DISTRIB_CODENAME main" &gt; /etc/apt/sources.list.d/ros-latest.list'</span></div><div class="line"></div><div class="line">2.[设置秘钥]</div><div class="line">sudo apt-key adv --keyserver <span class="string">'hkp://keyserver.ubuntu.com:80'</span> --recv-key C1CF6E31E6BADE8868B172B4F42ED6FBAB17C654</div><div class="line"></div><div class="line">3.[安装ROS文件]</div><div class="line">sudo apt update</div><div class="line">sudo apt install ros-melodic-desktop-full     <span class="comment"># ubuntu 18.04</span></div><div class="line">sudo apt install ros-noetic-desktop-full      <span class="comment"># ubuntu 20.04 </span></div><div class="line">如果提示找不到rosdep，执行sudo apt install python3-rosdep2，先安装rospack-tools包: sudo apt install rospack-tools</div><div class="line"></div><div class="line">4.[初始化rosdep] <span class="comment"># 安装过程中,执行该步骤,参考其他各种科学上网方法</span></div><div class="line">sudo rosdep init</div><div class="line">rosdep update</div><div class="line"></div><div class="line">5.[设置环境变量]</div><div class="line"><span class="built_in">echo</span> <span class="string">"source /opt/ros/melodic/setup.bash"</span> &gt;&gt; ~/.bashrc      <span class="comment"># ubuntu 18.04</span></div><div class="line"><span class="built_in">echo</span> <span class="string">"source /opt/ros/noetic/setup.bash"</span> &gt;&gt; ~/.bashrc       <span class="comment"># ubuntu 20.04</span></div><div class="line"><span class="built_in">source</span> ~/.bashrc</div><div class="line">执行上述命令后，可以输入ros并按tab键，正常情况下会输出很多ros开头的对应所有命令，如果环境变量设置有问题，将不会出现。</div><div class="line"></div><div class="line">6.[安装rosinstall]</div><div class="line">sudo apt install python-rosinstall python-rosinstall-generator python-wstool build-essential       <span class="comment"># ubuntu 18.04</span></div><div class="line">sudo apt install python3-rosinstall python3-rosinstall-generator python3-wstool build-essential    <span class="comment"># ubuntu 20.04</span></div><div class="line"></div><div class="line">7.[安装检查]</div><div class="line">ROS的默认安装路径为/opt/ros/noetic/，可进入该路径查看安装包是否存在。</div><div class="line">使用基本命令检查ROS是否安装成功。以下三条命令分别打开一个终端进行运行。执行中很多报错依赖包没安装，参考博客原文or百度安装即可。</div><div class="line">roscore                               <span class="comment"># 启动roscore</span></div><div class="line">rosrun turtlesim turtlesim_node       <span class="comment"># 启动小海龟仿真器</span></div><div class="line">rosrun turtlesim turtle_teleop_key    <span class="comment"># 启动海龟控制节点</span></div></pre></td></tr></table></figure></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;然后是两个utils的安装，这之前有依赖和环境搭建：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">1.[安装依赖项]</div><div class="line">sudo apt-get install libdw-dev</div><div class="line"></div><div class="line">2.[创建ros工作空间]</div><div class="line">mkdir -p ~/Documents/catkin_ws/src</div><div class="line"><span class="built_in">cd</span> ~/Documents/catkin_ws/src</div><div class="line">catkin_init_workspace</div><div class="line"><span class="built_in">cd</span> ~/Documents/catkin_ws/</div><div class="line">catkin_make</div><div class="line"><span class="built_in">source</span> ~/Documents/catkin_ws/devel/setup.bash</div></pre></td></tr></table></figure></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以下2个包，注意：先编译code_utils，再编译imu_utils，不能放在一起编译，imu_utils依赖code_utils。先把code_utils放在工作空间src下编译。再将imu_utils放到src下编译。</p>
<h6 id="2-core-utils安装"><a href="#2-core-utils安装" class="headerlink" title="2.core_utils安装"></a><strong>2.core_utils安装</strong></h6><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> ~/Documents/catkin_ws/src</div><div class="line">git <span class="built_in">clone</span> https://github.com/gaowenliang/code_utils.git</div><div class="line"><span class="built_in">cd</span> ~/Documents/catkin_ws/</div><div class="line">catkin_make</div></pre></td></tr></table></figure>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;报错 fatal error: backward.hpp: 没有那个文件或目录，在code_utils下面找到sumpixel_test.cpp，修改#include “backward.hpp”为#include “code_utils/backward.hpp”后再catkin_make。</p>
<h6 id="3-imu-utils安装"><a href="#3-imu-utils安装" class="headerlink" title="3.imu_utils安装"></a><strong>3.imu_utils安装</strong></h6><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> ~/Documents/atkin_ws/src</div><div class="line">git <span class="built_in">clone</span> https://github.com/gaowenliang/imu_utils.git</div><div class="line"><span class="built_in">cd</span> ~/Documents/catkin_ws/</div><div class="line">catkin_make</div><div class="line"><span class="built_in">source</span> ~/Documents/catkin_ws/devel/setup.bash</div></pre></td></tr></table></figure>
<h6 id="4-标定工具Kalibr"><a href="#4-标定工具Kalibr" class="headerlink" title="4.标定工具Kalibr"></a><strong>4.标定工具Kalibr</strong></h6><p>官网：<a href="https://github.com/ethz-asl/kalibr" target="_blank" rel="external">https://github.com/ethz-asl/kalibr</a><br>安装文档：<a href="https://github.com/ethz-asl/kalibr/wiki/installation" target="_blank" rel="external">https://github.com/ethz-asl/kalibr/wiki/installation</a><br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">1.[安装依赖项]</div><div class="line">sudo apt-get install -y </div><div class="line">git wget autoconf automake nano </div><div class="line">libeigen3-dev libboost-all-dev libsuitesparse-dev </div><div class="line">doxygen libopencv-dev </div><div class="line">libpoco-dev libtbb-dev libblas-dev liblapack-dev libv4l-dev</div><div class="line"></div><div class="line">2.[安装python包]</div><div class="line">sudo apt-get install -y python3-dev python3-pip python3-scipy </div><div class="line">python3-matplotlib ipython3 python3-wxgtk4.0 python3-tk python3-igraph</div><div class="line"></div><div class="line">3.[建立工作空间]</div><div class="line">mkdir -p ~/文档/catkin_ws/src</div><div class="line"><span class="built_in">cd</span> ~/文档/catkin_ws/</div><div class="line"><span class="built_in">export</span> ROS1_DISTRO=noetic     <span class="comment">#--kinetic=16.04, melodic=18.04, noetic=20.04</span></div><div class="line"><span class="built_in">source</span> /opt/ros/<span class="variable">$ROS1_DISTRO</span>/setup.bash</div><div class="line">catkin init</div><div class="line">catkin config --extend /opt/ros/<span class="variable">$ROS1_DISTRO</span></div><div class="line">catkin config --merge-devel   <span class="comment">#--Necessary for catkin_tools&gt;=0.4.</span></div><div class="line">catkin config --cmake-args -DCMAKE_BUILD_TYPE=Release</div><div class="line"></div><div class="line">4.[源码安装]</div><div class="line"><span class="built_in">cd</span> ~/文档/catkin_ws/src</div><div class="line">git <span class="built_in">clone</span> https://github.com/ethz-asl/kalibr.git</div><div class="line"><span class="built_in">cd</span> ~/文档/catkin_ws/</div><div class="line">catkin build -DCMAKE_BUILD_TYPE=Release -j4</div><div class="line"></div><div class="line">5.[运行]</div><div class="line"><span class="built_in">source</span> ~/Documents/catkin_ws/devel/setup.bash</div><div class="line">rosrun kalibr &lt;command_you_want_to_run_here&gt;</div></pre></td></tr></table></figure></p>
<h5 id="四、双目相机标定"><a href="#四、双目相机标定" class="headerlink" title="四、双目相机标定"></a>四、双目相机标定</h5><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;利用Kalibr工具进行双目标定。</p>
<h6 id="1-创建新ros空间"><a href="#1-创建新ros空间" class="headerlink" title="1.创建新ros空间"></a>1.创建新ros空间</h6><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;已如上述说明。</p>
<h6 id="2-标定板制作"><a href="#2-标定板制作" class="headerlink" title="2.标定板制作"></a>2.标定板制作</h6><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://github.com/ethz-asl/kalibr/wiki/downloads" target="_blank" rel="external">下载链接</a>，包含三种类型标定板(Aprilgrid, Checkerboard, Circlegrid)，其中Aprilgrid含序号，能防止计算位姿时跳帧，故用Aprilgrid标定。</p>
<h6 id="3-示例"><a href="#3-示例" class="headerlink" title="3.示例"></a>3.示例</h6><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;下载链接同上，含多相机标定(Multiple camera calibration)、IMU+相机联合标定(IMU-camera calibration)，此处先用前者标定相机，包括：相机参数文件camchain.yaml、标定结果文件target.yaml、录制数据集.bag文件。</p>
<h6 id="4-录制bag数据集"><a href="#4-录制bag数据集" class="headerlink" title="4.录制bag数据集"></a>4.录制bag数据集</h6><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;为了之后imu+相机联合标定，此处采集双目+imu的数据。若已有通过ros发布image和imu消息节点，只需用rosbag record工具将拍摄到的标定板图像制作成.bag文件即可。注意默认设备采集的频率为20~60Hz，会使标定图像过多，计算量太大。采集时最好将ros topic频率降低到4Hz左右。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ros可更改topic发布频率的节点throttle，分别打开两个终端，运行以下命令：(其中原始话题名称：/mynteye/left/image_raw、/mynteye/right/image_raw，更改频率后话题名称：/left、/right)<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">rosrun</div><div class="line">rosrun topic_tools throttle messages /mynteye/left/image_raw 4.0 /left</div><div class="line">rosrun topic_tools throttle messages /mynteye/right/image_raw 4.0 /right</div></pre></td></tr></table></figure></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;然后录制bag，参考：<a href="https://www.bilibili.com/video/BV1gA411w7EM/?is_story_h5=false&amp;p=1&amp;share_from=ugc&amp;share_medium=android&amp;share_plat=android&amp;share_session_id=4cb33025-a24d-435f-adfc-7e10953ecc92&amp;share_source=WEIXIN&amp;share_tag=s_i&amp;timestamp=1671450944&amp;unique_k=vMzZHAU" target="_blank" rel="external">Kalibr标定视频教程</a>。<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rosbag record -O stereo_calibra.bag /left /right /imu</div></pre></td></tr></table></figure></p>
<h6 id="5-进行标定"><a href="#5-进行标定" class="headerlink" title="5.进行标定"></a>5.进行标定</h6><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;进入下载示例Multiple camera calibration文件夹，修改camchain.yaml文件：话题名称、频率、标定板尺寸。（详见视频教程）<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;打开终端输入命令：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">source</span> devel/setup.bash</div><div class="line">rosrun kalibr kalibr_calibrate_cameras --bag /home/admin/stereo_calibra.bag --topics /left /right --models pinhole-equi pinhole-equi --target /home/admin/april_6x6_80x80cm_A0.yaml</div></pre></td></tr></table></figure></p>
<h6 id="6-标定结果"><a href="#6-标定结果" class="headerlink" title="6.标定结果"></a>6.标定结果</h6><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;标定完成后，生成cam-chain.yaml文件，包含：相机内参、畸变参数、基线等。<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="attr">cam0:</span></div><div class="line"><span class="attr">  cam_overlaps:</span> <span class="string">[1]</span></div><div class="line"><span class="attr">  camera_model:</span> <span class="string">pinhole</span></div><div class="line"><span class="attr">  distortion_coeffs:</span> <span class="string">[0.2783471016021346,</span> <span class="number">0.6964790605940689</span><span class="string">,</span> <span class="bullet">-1.7636165117280103</span><span class="string">,</span> <span class="number">1.9185066948675424</span><span class="string">]</span></div><div class="line"><span class="attr">  distortion_model:</span> <span class="string">equidistant</span></div><div class="line"><span class="attr">  intrinsics:</span> <span class="string">[464.46660755800724,</span> <span class="number">465.36764628863784</span><span class="string">,</span> <span class="number">345.1018538803555</span><span class="string">,</span> <span class="number">229.48918054311704</span><span class="string">]</span></div><div class="line"><span class="attr">  resolution:</span> <span class="string">[640,</span> <span class="number">480</span><span class="string">]</span></div><div class="line"><span class="attr">  rostopic:</span> <span class="string">/left</span></div><div class="line"><span class="attr">cam1:</span></div><div class="line"><span class="attr">  T_cn_cnm1:</span></div><div class="line"><span class="bullet">  -</span> <span class="string">[0.9996465213666637,</span> <span class="bullet">-0.02537787899957037</span><span class="string">,</span> <span class="number">0.007924366031799834</span><span class="string">,</span> <span class="bullet">-0.11251195025612559</span><span class="string">]</span></div><div class="line"><span class="bullet">  -</span> <span class="string">[0.02547649136646326,</span> <span class="number">0.9995959921960228</span><span class="string">,</span> <span class="bullet">-0.012601617884125324</span><span class="string">,</span> <span class="bullet">-0.0017042839059835384</span><span class="string">]</span></div><div class="line"><span class="bullet">  -</span> <span class="string">[-0.0076013621922192826,</span> <span class="number">0.012799048524251695</span><span class="string">,</span> <span class="number">0.9998891956860474</span><span class="string">,</span> <span class="bullet">-0.0005072054140188229</span><span class="string">]</span></div><div class="line"><span class="bullet">  -</span> <span class="string">[0.0,</span> <span class="number">0.0</span><span class="string">,</span> <span class="number">0.0</span><span class="string">,</span> <span class="number">1.0</span><span class="string">]</span></div><div class="line"><span class="attr">  cam_overlaps:</span> <span class="string">[0]</span></div><div class="line"><span class="attr">  camera_model:</span> <span class="string">pinhole</span></div><div class="line"><span class="attr">  distortion_coeffs:</span> <span class="string">[0.2682739040565608,</span> <span class="number">0.7579325851647005</span><span class="string">,</span> <span class="bullet">-2.0708675842774156</span><span class="string">,</span></div><div class="line">    <span class="number">2.3962970091118696</span><span class="string">]</span></div><div class="line"><span class="attr">  distortion_model:</span> <span class="string">equidistant</span></div><div class="line"><span class="attr">  intrinsics:</span> <span class="string">[461.8506067496413,</span> <span class="number">462.2467047389745</span><span class="string">,</span> <span class="number">325.2758830849641</span><span class="string">,</span> <span class="number">247.10152372631737</span><span class="string">]</span></div><div class="line"><span class="attr">  resolution:</span> <span class="string">[640,</span> <span class="number">480</span><span class="string">]</span></div><div class="line"><span class="attr">  rostopic:</span> <span class="string">/right</span></div></pre></td></tr></table></figure></p>
<p><div align="center" style="width:60%;height:60%;margin:0 auto;"><img src="/resources/calib-reprojection-error-stereo.jpg" alt="figure-stereo-reprojection-errors"></div></p>
<center><h7 style="color:grey">图1 双目标定的重投影误差</h7></center>

<h5 id="五、IMU标定"><a href="#五、IMU标定" class="headerlink" title="五、IMU标定"></a>五、IMU标定</h5><h6 id="1-录制imu-bag"><a href="#1-录制imu-bag" class="headerlink" title="1.录制imu.bag"></a>1.录制imu.bag</h6><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;此处采用imu_utils进行标定。保持imu静止不动至少2小时，录制imu数据集.bag。<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rosbag record /imu -O imu</div></pre></td></tr></table></figure></p>
<h6 id="2-修改launch文件"><a href="#2-修改launch文件" class="headerlink" title="2.修改launch文件"></a>2.修改launch文件</h6><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;自定义可选，修改src/imu_utils-master/launch文件，包括名字、时长之类。(比如: mynt_imu.launch)。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">launch</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">"imu_utils"</span> <span class="attr">type</span>=<span class="string">"imu_an"</span> <span class="attr">name</span>=<span class="string">"imu_an"</span> <span class="attr">output</span>=<span class="string">"screen"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"imu_topic"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">value</span>=<span class="string">"/imu0"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"imu_name"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">value</span>=<span class="string">"16448"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"data_save_path"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">value</span>=<span class="string">"$(find imu_utils)/data/"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"max_time_min"</span> <span class="attr">type</span>=<span class="string">"int"</span> <span class="attr">value</span>=<span class="string">"120"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"max_cluster"</span> <span class="attr">type</span>=<span class="string">"int"</span> <span class="attr">value</span>=<span class="string">"100"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">node</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">launch</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h6 id="3-进行标定"><a href="#3-进行标定" class="headerlink" title="3.进行标定"></a>3.进行标定</h6><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">roscore</div><div class="line">rosbag play -r 200　imu_utils/imu.bag    <span class="comment"># 播放bag文件:以200速度播放,而非实际等待时长2h</span></div></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> imu_ws</div><div class="line"><span class="built_in">source</span> ./devel/setup.bash</div><div class="line">roslaunch imu_utils mynt_imu.launch      <span class="comment"># 运行launch文件</span></div></pre></td></tr></table></figure>
<h6 id="4-标定结果"><a href="#4-标定结果" class="headerlink" title="4.标定结果"></a>4.标定结果</h6><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;标定结束，生成cam-imu.yaml文件，在data目录: src/imu_utils/data/m210_imu_param.yaml，包含：各方向的随机噪声、随机游走。<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="string">%YAML:1.0</span></div><div class="line"><span class="meta">---</span></div><div class="line"><span class="attr">type:</span> <span class="string">IMU</span></div><div class="line"><span class="attr">name:</span> <span class="string">m210</span></div><div class="line"><span class="attr">Gyr:</span></div><div class="line"><span class="attr">   unit:</span> <span class="string">" rad/s"</span></div><div class="line"><span class="attr">   avg-axis:</span></div><div class="line"><span class="attr">      gyr_n:</span> <span class="number">1.1016440992489866e-03</span></div><div class="line"><span class="attr">      gyr_w:</span> <span class="number">5.7968344392887427e-06</span></div><div class="line"><span class="attr">   x-axis:</span></div><div class="line"><span class="attr">      gyr_n:</span> <span class="number">1.2601308952358316e-03</span></div><div class="line"><span class="attr">      gyr_w:</span> <span class="number">6.6549144466689008e-06</span></div><div class="line"><span class="attr">   y-axis:</span></div><div class="line"><span class="attr">      gyr_n:</span> <span class="number">9.1639862355727669e-04</span></div><div class="line"><span class="attr">      gyr_w:</span> <span class="number">4.5920115983527386e-06</span></div><div class="line"><span class="attr">   z-axis:</span></div><div class="line"><span class="attr">      gyr_n:</span> <span class="number">1.1284027789538512e-03</span></div><div class="line"><span class="attr">      gyr_w:</span> <span class="number">6.1435772728445881e-06</span></div><div class="line"><span class="attr">Acc:</span></div><div class="line"><span class="attr">   unit:</span> <span class="string">" m/s^2"</span></div><div class="line"><span class="attr">   avg-axis:</span></div><div class="line"><span class="attr">      acc_n:</span> <span class="number">5.1380013730273288e-02</span></div><div class="line"><span class="attr">      acc_w:</span> <span class="number">1.7544697355051581e-03</span></div><div class="line"><span class="attr">   x-axis:</span></div><div class="line"><span class="attr">      acc_n:</span> <span class="number">3.1145378555559291e-02</span></div><div class="line"><span class="attr">      acc_w:</span> <span class="number">2.9961069437766212e-03</span></div><div class="line"><span class="attr">   y-axis:</span></div><div class="line"><span class="attr">      acc_n:</span> <span class="number">7.0380818146931270e-02</span></div><div class="line"><span class="attr">      acc_w:</span> <span class="number">1.9377334256450410e-03</span></div><div class="line"><span class="attr">   z-axis:</span></div><div class="line"><span class="attr">      acc_n:</span> <span class="number">5.2613844488329294e-02</span></div><div class="line"><span class="attr">      acc_w:</span> <span class="number">3.2956883709381275e-04</span></div></pre></td></tr></table></figure></p>
<h5 id="六、双目-IMU联合标定"><a href="#六、双目-IMU联合标定" class="headerlink" title="六、双目+IMU联合标定"></a>六、双目+IMU联合标定</h5><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;目标：获取相机内参到imu的相对转换矩阵。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;与kalibr标定双目过程类似，这次在IMU-camera calibration例子基础上，标定imu与camera。首先以上两次标定结果修改.yaml参数，包括：标定结果、话题类型、频率等。<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kalibr_calibrate_imu_camera --target april_6x6.yaml --cam camchain.yaml --imu imu_adis16448.yaml --bag /home/admin/calib/stereo/imu_stereo.bag --bag-from-to 5 45</div></pre></td></tr></table></figure></p>
<h6 id="标定结果"><a href="#标定结果" class="headerlink" title="标定结果"></a>标定结果</h6><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.txt文件中的部分结果，包含相机与imu之间的转换矩阵。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">Calibration results</div><div class="line">===================</div><div class="line">Normalized Residuals</div><div class="line">----------------------------</div><div class="line">Reprojection error (cam0):     mean 0.126389437034, median 0.117608381877, std: 0.0673478862055</div><div class="line">Reprojection error (cam1):     mean 0.132576172002, median 0.12130080264, std: 0.0739372479366</div><div class="line">Gyroscope error (imu0):        mean 0.000146638755352, median 3.16696236165e-07, std: 0.0014737840839</div><div class="line">Accelerometer error (imu0):    mean 1.14000452874e-06, median 1.02723705118e-08, std: 6.0143590628e-06</div><div class="line"></div><div class="line">Residuals</div><div class="line">----------------------------</div><div class="line">Reprojection error (cam0) [px]:     mean 0.126389437034, median 0.117608381877, std: 0.0673478862055</div><div class="line">Reprojection error (cam1) [px]:     mean 0.132576172002, median 0.12130080264, std: 0.0739372479366</div><div class="line">Gyroscope error (imu0) [rad/s]:     mean 5.18446291471e-06, median 1.11969028084e-08, std: 5.21061359864e-05</div><div class="line">Accelerometer error (imu0) [m/s^2]: mean 8.06104932854e-08, median 7.26366284774e-10, std: 4.2527940778e-07</div><div class="line"></div><div class="line">Transformation (cam0):</div><div class="line">-----------------------</div><div class="line">T_ci:  (imu0 to cam0): </div><div class="line">[[-0.02093225 -0.99971259  0.01168657 -0.00021865]</div><div class="line"> [ 0.13518962 -0.01441203 -0.99071492 -0.00086208]</div><div class="line"> [ 0.99059861 -0.01915798  0.13545244  0.00014753]</div><div class="line"> [ 0.          0.          0.          1.        ]]</div><div class="line"></div><div class="line">T_ic:  (cam0 to imu0): </div><div class="line">[[-0.02093225  0.13518962  0.99059861 -0.00003417]</div><div class="line"> [-0.99971259 -0.01441203 -0.01915798 -0.00022818]</div><div class="line"> [ 0.01168657 -0.99071492  0.13545244 -0.00087151]</div><div class="line"> [ 0.          0.          0.          1.        ]]</div><div class="line"></div><div class="line">timeshift cam0 to imu0: [s] (t_imu = t_cam + shift)</div><div class="line">0.000336885304337</div></pre></td></tr></table></figure></p>
<p><div align="center" style="width:60%;height:60%;margin:0 auto;"><img src="/resources/calib-reprojection-error-stereo-imu.jpg" alt="figure-stereo-imu-reprojection-errors"></div></p>
<center><h7 style="color:grey">图2 双目+imu联合标定的重投影误差</h7></center>

<h5 id="七、参考文献"><a href="#七、参考文献" class="headerlink" title="七、参考文献"></a>七、参考文献</h5><p>[1] Kalibr官网：<a href="https://github.com/ethz-asl/kalibr/wiki/" target="_blank" rel="external">https://github.com/ethz-asl/kalibr/wiki/</a><br>[2] Kalibr源码：<a href="https://github.com/ethz-asl/kalibr/" target="_blank" rel="external">https://github.com/ethz-asl/kalibr/</a><br>[3] Kalibr标定教程：<a href="https://www.youtube.com/watch?app=desktop&amp;v=puNXsnrYWTY/" target="_blank" rel="external">https://www.youtube.com/watch?app=desktop&amp;v=puNXsnrYWTY/</a></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Camera-Calibration/" rel="tag"># Camera Calibration</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2022/10/09/2022-10-09-TBB/" rel="next" title="TBB并行加速优化Slam计算框架">
                <i class="fa fa-chevron-left"></i> TBB并行加速优化Slam计算框架
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2023/01/03/2023-01-03-SLAM/" rel="prev" title="SLAM定位建图和轨迹评估">
                SLAM定位建图和轨迹评估 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="uyan_frame"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/psb.jpg"
               alt="DianaCody" />
          <p class="site-author-name" itemprop="name">DianaCody</p>
           
              <p class="site-description motion-element" itemprop="description">Researcher, Focus on Artificial Intelligence</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">29</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">15</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">62</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/dianacody" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://facebook.com/dianacody" target="_blank" title="Facebook">
                  
                    <i class="fa fa-fw fa-facebook"></i>
                  
                  Facebook
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/dianacody" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://blog.csdn.net/dianacody" title="CSDN Blog" target="_blank">CSDN Blog</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-5"><a class="nav-link" href="#一、概述"><span class="nav-number">1.</span> <span class="nav-text">一、概述</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#二、相机参数说明"><span class="nav-number">2.</span> <span class="nav-text">二、相机参数说明</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1-相机chain-yaml"><span class="nav-number">2.1.</span> <span class="nav-text">1.相机chain.yaml</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-imu配置：imu-yaml"><span class="nav-number">2.2.</span> <span class="nav-text">2.imu配置：imu.yaml</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#三、标定环境搭建"><span class="nav-number">3.</span> <span class="nav-text">三、标定环境搭建</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1-ros安装"><span class="nav-number">3.1.</span> <span class="nav-text">1.ros安装</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-core-utils安装"><span class="nav-number">3.2.</span> <span class="nav-text">2.core_utils安装</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-imu-utils安装"><span class="nav-number">3.3.</span> <span class="nav-text">3.imu_utils安装</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#4-标定工具Kalibr"><span class="nav-number">3.4.</span> <span class="nav-text">4.标定工具Kalibr</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#四、双目相机标定"><span class="nav-number">4.</span> <span class="nav-text">四、双目相机标定</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1-创建新ros空间"><span class="nav-number">4.1.</span> <span class="nav-text">1.创建新ros空间</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-标定板制作"><span class="nav-number">4.2.</span> <span class="nav-text">2.标定板制作</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-示例"><span class="nav-number">4.3.</span> <span class="nav-text">3.示例</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#4-录制bag数据集"><span class="nav-number">4.4.</span> <span class="nav-text">4.录制bag数据集</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#5-进行标定"><span class="nav-number">4.5.</span> <span class="nav-text">5.进行标定</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#6-标定结果"><span class="nav-number">4.6.</span> <span class="nav-text">6.标定结果</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#五、IMU标定"><span class="nav-number">5.</span> <span class="nav-text">五、IMU标定</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1-录制imu-bag"><span class="nav-number">5.1.</span> <span class="nav-text">1.录制imu.bag</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-修改launch文件"><span class="nav-number">5.2.</span> <span class="nav-text">2.修改launch文件</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-进行标定"><span class="nav-number">5.3.</span> <span class="nav-text">3.进行标定</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#4-标定结果"><span class="nav-number">5.4.</span> <span class="nav-text">4.标定结果</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#六、双目-IMU联合标定"><span class="nav-number">6.</span> <span class="nav-text">六、双目+IMU联合标定</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#标定结果"><span class="nav-number">6.1.</span> <span class="nav-text">标定结果</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#七、参考文献"><span class="nav-number">7.</span> <span class="nav-text">七、参考文献</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2013 - 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">DianaCody</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  
    

    
      <!-- UY BEGIN -->
      <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=dianacody"></script>
      <!-- UY END -->
    
  





  






  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>





  

  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

</body>
</html>
