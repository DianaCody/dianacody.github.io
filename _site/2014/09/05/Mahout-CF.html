<!DOCTYPE html>
<html>
<head>
  <!--
    **
    *
    * Author:         DianaCody
    * Contact:        dianacodyleaf@gmail.com
    * Theme Name:     Block Rude
    * Version:        1.0
    *
    **
  -->
  <meta charset="utf-8" />
  <title>Mahout基于协同过滤(CF)的用户推荐 | DianaCody's Shell</title>
  <meta name="generator" content="Jekyll" />
  <meta name="author" content="DianaCody" />
  <meta name="description" content="" />
  <link rel="stylesheet" href="/css/style.css" type="text/css" />
  <link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/atom.xml" />
  <link rel="shortcut icon" href="images/favicon.jpg" type="image/x-icon" />
</head>
<body>
    <header class="head">
	<div class="header fn-clear">
		<section class="header-cnt fn-clear">
			<div class="logo">
				<div class="logo-cnt">
				 	<h1><a href="/">DianaCody's Shell</a></h1>
				 	<h2>Focus on Search Engine, ML & IR & NLP.</h2>
				</div>
			</div>
			<nav class="nav">
				<ul>
					<li><a href="/" >Home</a></li>
					<li><a href="/archives.html" >Archives</a></li>					
					<li><a href="/contact.html" >About & Contact</a></li>
					<!-- <li><a href="/resume.html" >Resume</a></li> -->
					<li><a href="/atom.xml" target="_blank" >Rss</a></li>
				</ul>
			</nav>
		</section>
	</div>
</header> 
  <section id="content">
    <article id="contenter">
      <section class="content">
	<div class="content-cnt fn-clear">
		<div class="main fn-clear">
			<article class="entry">
				<h1 class="title">Mahout基于协同过滤(CF)的用户推荐</h1>
               	<p class="meta"><time class="date" pubdate="2014-09-05">05 Sep 2014</time> By <a href="/contact.html" class="author" title="author">DianaCody</a><g:plusone size="small"></g:plusone></p>
               	<p class="description">Mahout提供一些可扩展的机器学习领域经典算法的实现。</p>
 			 	<h5>一、Mahout推荐算法简介</h5>

<p>Mahout算法框架自带的推荐器有下面这些：</p>

<blockquote><ul>
<li>GenericUserBasedRecommender：基于用户的推荐器，用户数量少时速度快；</li>
<li>GenericItemBasedRecommender：基于商品推荐器，商品数量少时速度快，尤其当外部提供了商品相似度数据后效率更好；</li>
<li>SlopeOneRecommender：基于slope-one算法的推荐器，在线推荐或更新较快，需要事先大量预处理运算，物品数量少时较好；</li>
<li>SVDRecommender：奇异值分解，推荐效果较好，但之前需要大量预处理运算；</li>
<li>KnnRecommender：基于k近邻算法(KNN)，适合于物品数量较小时；</li>
<li>TreeClusteringRecommender：基于聚类的推荐器，在线推荐较快，之前需要大量预处理运算，用户数量较少时效果好；</li>
</ul>
</blockquote>

<p>Mahout最常用的三个推荐器是上述的前三个，本文的实例仅“基于用户的推荐器”做个实验，其实大体原理都差不多。</p>

<h5>二、基于协同过滤(CF)模型的用户推荐</h5>

<p>Mahout里自带的基本CF模型原理如下：</p>

<p>GenericUserBasedRecommender是基于用户(user-based)的简单推荐器实现类，推荐主要参照传入的DataModel和UserNeighborhood，总体是三个步骤：</p>

<p>(1) 从UserNeighborhood获取当前用户Ui最相似的K个用户集合{U1, U2, …Uk}；</p>

<p>(2) 从这K个用户集合排除Ui的偏好商品，剩下的Item集合为{Item0, Item1, …Itemm}；</p>

<p>(3) 对Item集合里每个Itemj计算Ui可能偏好程度值pref(Ui, Itemj)，并把Item按此数值从高到低排序，前N个item推荐给用户Ui。</p>

<h5>三、源码</h5>

<pre><code class="java">import java.util.List;  
import org.apache.mahout.cf.taste.common.TasteException;  
import org.apache.mahout.cf.taste.impl.neighborhood.NearestNUserNeighborhood;  
import org.apache.mahout.cf.taste.impl.recommender.GenericUserBasedRecommender;  
import org.apache.mahout.cf.taste.impl.similarity.PearsonCorrelationSimilarity;  
import org.apache.mahout.cf.taste.model.DataModel;  
import org.apache.mahout.cf.taste.model.JDBCDataModel;  
import org.apache.mahout.cf.taste.neighborhood.UserNeighborhood;  
import org.apache.mahout.cf.taste.recommender.RecommendedItem;  
import org.apache.mahout.cf.taste.similarity.UserSimilarity;  

import com.mysql.MysqlDataSource;  

/** 
 *  mahout基于协同过滤(CF)的推荐 
 * 
 */  
public class Mahout {  
    public static void main(String[] args) throws TasteException {  

        //(1)----连接数据库部分  
        MysqlDataSource dataSource = new MysqlDataSource();  
        dataSource.setServerName("localhost");  
        dataSource.setUser("admin");  
        dataSource.setPassword("admin");  
        dataSource.setDatabaseName("mahoutDB");  
        //(2)----使用MySQLJDBCDataModel数据源读取MySQL里的数据  
        JDBCDataModel dataModel = new MySQLJDBCDataModel(dataSource, "table1", "userId", "itemId", "preference", "date");  

        //(3)----数据模型部分  
        //把MySQLJDBCDataModel对象赋值给DataModel  
        DataModel model = dataModel;  
        //用户相似度UserSimilarity:包含相似性度量和邻居参数  
        UserSimilarity similarity = new PearsonCorrelationSimilarity(model);  
        //相邻用户UserNeighborhood  
        UserNeighborhood neighborhood = new NearestNUserNeighborhood(2, similarity, model);  
        //一旦确定相邻用户,一个普通的user-based推荐器被构建,构建一个GenericUserBasedRecommender推荐器需要数据源DataModel,用户相似性UserSimilarity,相邻用户相似度UserNeighborhood  
        Recommender recommender = new GenericUserBasedRecommender(model, neighborhood, similarity);  
        //向用户1推荐2个商品  
        List&lt;RecommandedItem&gt; recommendations = recommender.recommend(1, 2);  
        for(RecommendedItem recommendation : recommendations){  
            //输出推荐结果  
            System.out.println(recommendation);  
        }  
    }  

}  
</code></pre>

<p>.</p>

                <nav class="pagination-link">
                    
                    <a class="prev" href="/2013/04/28/markdown.html" rel="bookmark">&laquo;&nbsp;MarkDown文章</a>
                    
                    
                    <a class="next" href="/2014/09/25/CF.html" rel="bookmark">User-Based CF和Item-Based CF协同过滤推荐&nbsp;&raquo;</a>
                    
                 </nav>
			</article><!-- .entry -->		
		</div>
		<div class="aside fn-clear">
			<div class="box fn-clear">
	<img src="/images/psb.jpg" alt="about theme"/>
	<!-- modify by dianacody-->
	<ul>
		<li><b>I'M DianaCody</b></li>
		<li><i>dianacodyleaf@gmail.com</i></li>
		<li>DianaCody, a postgraduate student from BUPT. 1/2 coder, 1/2 writer. Love coding, writing and open-source, also reading and traveling sometimes.</li>
		<li>Interest Fields：Search Engine, Data Mining, Machine Learning, NLP. </li>
	</ul>
	
</div>
			<div class="box fn-clear">
	<h3 class="title">GitHub Project</h3>
	<ul>
		<li>&#8227;<a href="https://github.com/DianaCody/RecommandSystem/">Personal Recommand System</a></li>
		<li>&#8227;<a href="https://github.com/DianaCody/Spider_SinaTweetCrawler_java/">Spider SinaWeibo_Crawler</a></li>
		<li>&#8227;<a href="https://github.com/DianaCody/Spider_python/">Tweet Crawler</a></li>
		<li>&#8227;<a href="https://github.com/DianaCody/Translator/">Translator Plugin</a></li>
	</ul>
</div>
			<div class="box fn-clear">
	<h3 class="title">CSDN Blog</h3>
	<ul>
		<li><a href="http://blog.csdn.net/dianacody">http://blog.csdn.net/dianacody</a></li>
	</ul>

	<!--
	<p>This is a jekyll blog theme.</p>
	-->	
</div>
		</div>

		<!-- 多说评论框 -->
    	<div class="ds-thread" data-thread-key=/2014/09/05/Mahout-CF data-title=Mahout基于协同过滤(CF)的用户推荐 data-url="dianacody.github.io/2014/09/05/Mahout-CF.html">
    	</div>
		
		<!-- 多说公共JS代码 -->
		<script type="text/javascript">
		var duoshuoQuery = {short_name:"dianacody"};
			(function() {
				var ds = document.createElement('script');
				ds.type = 'text/javascript';ds.async = true;
				ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
				ds.charset = 'UTF-8';
				(document.getElementsByTagName('head')[0] 
				 || document.getElementsByTagName('body')[0]).appendChild(ds);
			})();
		</script>

		<!-- 多说分享插件 -->
		<div class="ds-share" data-thread-key=/2014/09/05/Mahout-CF data-title=Mahout基于协同过滤(CF)的用户推荐 data-images="" data-content="" data-url=/2014/09/05/Mahout-CF.html>
	    	<div class="ds-share-inline">
	      		<ul  class="ds-share-icons-16">      	
	      			<li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
	        		<li><a class="ds-weibo" href="http://weibo.com" data-service="weibo">新浪微博</a></li>
	        		<li><a class="ds-qzone" href="http://qzone.qq.com" data-service="qzone">QQ空间</a></li>
	        		<li><a class="ds-qqt" href="http://t.qq.com" data-service="qqt">腾讯微博</a></li>
	        		<li><a class="ds-wechat" href="http://wx.qq.com" data-service="wechat">微信</a></li>
	      		</ul>
	      		<div class="ds-share-icons-more"></div>
	    	</div>
 		</div>

	</div>
</section>
    </article>
  </section>
    <footer class="foot">
	<div class="foot-cnt fn-clear">
		<div class="foot-cnt-det fn-clear">
			<article class="blogroll">
				<h4 class="title">Links</h4>
				<ul>
					<li>&#8227;<a href="https://github.com/dianacody">DianaCody's Github</a></li>
					<li>&#8227;<a href="http://blog.csdn.net/dianacody">My csdn Blog</a></li>
					<!-- <li>&#8227;<a href="http://www.jekyllrb.com">www.jekyllrb.com</a></li> -->
				</ul>
			</article>
			<article class="about">
				<h4 class="title">About Me</h4>
				<p>DianaCody, a postgraduate student from BUPT. 1/2 coder, 1/2 writer. Love coding, writing and open-source, also reading and traveling sometimes.</p>
				<p>Interest Fields：Search Engine, Data Mining, Machine Learning, NLP. </p>
			</article>
			<article class="follow">
				<h4 class="title">Follow Me</h4>
				<ul>
					<li><a href="https://github.com/dianacody/" class="ico-github" target="_blank">github</a></li>
					<li><a href="/atom.xml" class="ico-rss" target="_blank">rss</a></li>
					<li><a href="http://www.linkedin.com/" class="ico-linkedin">linkedin</a></li>
					<li><a href="http://www.google.com/" class="ico-google">google</a></li>
					<li><a href="http://www.flickr.com/" class="ico-flickr">flickr</a></li>
					<li><a href="http://www.twitter.com/dianacody/" class="ico-twitter">twitter</a></li>
					<li><a href="http://www.facebook.com/" class="ico-facebook">facebook</a></li>
					<li><a href="http://www.vimeo.com/" class="ico-vimeo">vimeo</a></li>
				</ul>
			</article>
		</div>
	</div>
	<div class="foot-btn">
		<div class="foot-btn-det">
			<p class="copyright">© 2013-2015 DianaCody. All rights reserved.</p>
			<p class="author">Powered by <a href="http://www.jekyllrb.com">Jekyll</a>. Design by <a href="http://dianacody.github.io">DianaCody</a>.</p>
		</div>
	</div>
</footer>
</body>
</html>