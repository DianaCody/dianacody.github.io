<!DOCTYPE html>
<html>
<head>
  <!--
    **
    *
    * Author:         DianaCody
    * Contact:        dianacodyleaf@gmail.com
    * Theme Name:     Block Rude
    * Version:        1.0
    *
    **
  -->
  <meta charset="utf-8" />
  <title>中文分词-最大匹配算法 | DianaCody's Shell</title>
  <meta name="generator" content="Jekyll" />
  <meta name="author" content="DianaCody" />
  <meta name="description" content="" />
  <link rel="stylesheet" href="/css/style.css" type="text/css" />
  <link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/atom.xml" />
  <link rel="shortcut icon" href="images/favicon.jpg" type="image/x-icon" />
</head>
<body>
    <header class="head">
	<div class="header fn-clear">
		<section class="header-cnt fn-clear">
			<div class="logo">
				<div class="logo-cnt">
				 	<h1><a href="/">DianaCody's Shell</a></h1>
				 	<h2>Focus on Search Engine, ML & IR & NLP.</h2>
				</div>
			</div>
			<nav class="nav">
				<ul>
					<li><a href="/" >Home</a></li>
					<li><a href="/archives.html" >Archives</a></li>					
					<li><a href="/contact.html" >About & Contact</a></li>
					<!--<li><a href="/resume.html" >Resume</a></li>-->
					<li><a href="/atom.xml" target="_blank" >Rss</a></li>
				</ul>
			</nav>
		</section>
	</div>
</header> 
  <section id="content">
    <article id="contenter">
      <section class="content">
	<div class="content-cnt fn-clear">
		<div class="main fn-clear">
			<article class="entry">
				<h1 class="title">中文分词-最大匹配算法</h1>
               	<p class="meta"><time class="date" pubdate="2014-11-07">07 Nov 2014</time> By <a href="/contact.html" class="author" title="author">DianaCody</a><g:plusone size="small"></g:plusone></p>
               	<p class="description">中文分词在中文信息处理中是最最基础的，无论机器翻译亦或信息检索还是其他相关应用，如果涉及中文，都离不开中文分词，因此中文分词具有极高的地位。中文分词入门最简单应该是最大匹配法了。</p>
 			 	<p>正向最大匹配法算法如下所示:</p>

<p>逆向匹配法思想与正向一样，只是从右向左切分，这里举一个例子：</p>

<p>输入例句：S1=”计算语言学课程有意思” ；</p>

<p>定义：最大词长MaxLen = 5；S2= ” “；分隔符 = “/”；</p>

<p>假设存在词表：…，计算语言学，课程，意思，…；</p>

<p>最大逆向匹配分词算法过程如下：</p>

<ol>
<li><p>S2=””；S1不为空，从S1右边取出候选子串W=”课程有意思”；</p></li>
<li><p>查词表，W不在词表中，将W最左边一个字去掉，得到W=”程有意思”；</p></li>
<li><p>查词表，W不在词表中，将W最左边一个字去掉，得到W=”有意思”；</p></li>
<li><p>查词表，W不在词表中，将W最左边一个字去掉，得到W=”意思”</p></li>
<li><p>查词表，“意思”在词表中，将W加入到S2中，S2=” 意思/”，并将W从S1中去掉，此时S1=”计算语言学课程有”；</p></li>
<li><p>S1不为空，于是从S1左边取出候选子串W=”言学课程有”；</p></li>
<li><p>查词表，W不在词表中，将W最左边一个字去掉，得到W=”学课程有”；</p></li>
<li><p>查词表，W不在词表中，将W最左边一个字去掉，得到W=”课程有”；</p></li>
<li><p>查词表，W不在词表中，将W最左边一个字去掉，得到W=”程有”；</p></li>
<li><p>查词表，W不在词表中，将W最左边一个字去掉，得到W=”有”，这W是单字，将W加入到S2中，S2=“ /有 /意思”，并将W从S1中去掉，此时S1=”计算语言学课程”；</p></li>
<li><p>S1不为空，于是从S1左边取出候选子串W=”语言学课程”；</p></li>
<li><p>查词表，W不在词表中，将W最左边一个字去掉，得到W=”言学课程”；</p></li>
<li><p>查词表，W不在词表中，将W最左边一个字去掉，得到W=”学课程”；</p></li>
<li><p>查词表，W不在词表中，将W最左边一个字去掉，得到W=”课程”；</p></li>
<li><p>查词表，“意思”在词表中，将W加入到S2中，S2=“ 课程/ 有/ 意思/”，并将W从S1中去掉，此时S1=”计算语言学”；</p></li>
<li><p>S1不为空，于是从S1左边取出候选子串W=”计算语言学”；</p></li>
<li><p>查词表，“计算语言学”在词表中，将W加入到S2中，S2=“计算语言学/ 课程/ 有/ 意思/”，并将W从S1中去掉，此时S1=””；</p></li>
<li><p>S1为空，输出S2作为分词结果，分词过程结束。</p></li>
</ol>


<p>相应程序示例：</p>

<p>准备文件：建立一个词表文件wordlexicon，格式如下</p>

<ul>
<li>计算语言学</li>
<li>课程</li>
<li>意思</li>
</ul>


<p>输入文件：test,格式如下</p>

<ul>
<li>计算语言学课程有意思</li>
</ul>


<p>编译后执行如下：SegWord.exe test，输出分词结果文件：SegmentResult.txt</p>

<p><strong>源代码如下：</strong></p>

<pre><code>// Dictionary.h
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;fstream&gt;
#include &lt;sstream&gt;
#include &lt;hash_map&gt;
using namespace std;
using namespace stdext;
class CDictionary
{
    public:
        CDictionary(); //将词典文件读入并构造为一个哈希词典
        ~CDictionary();
        int FindWord(string w); //在哈希词典中查找词
    private:
        string strtmp; //读取词典的每一行
        string word; //保存每个词
        hash_map&lt;string, int&gt; wordhash; // 用于读取词典后的哈希
        hash_map&lt;string, int &gt;::iterator worditer; //
        typedef pair&lt;string, int&gt; sipair;
};
//将词典文件读入并构造为一个哈希词典
CDictionary::CDictionary()
{
    ifstream infile(“wordlexicon”); // 打开词典
    if (!infile.is_open()) // 打开词典失败则退出程序
    {
        cerr &lt;&lt; "Unable to open input file: " &lt;&lt; "wordlexicon"
&lt;&lt; " -- bailing out!" &lt;&lt; endl;
        exit(-1);
    }
    while (getline(infile, strtmp, '\\n')) // 读入词典的每一行并将其添加入哈希中
    {
        istringstream istr(strtmp);
        istr &gt;&gt; word; //读入每行第一个词
        wordhash.insert(sipair(word, 1)); //插入到哈希中
    }
}

CDictionary::~CDictionary()
{
}

//在哈希词典中查找词，若找到，则返回，否则返回
int CDictionary::FindWord(string w)
{
    if (wordhash.find(w) != wordhash.end())
    {
        return 1;
    }
    else
    {
        return 0;
    }
}
</code></pre>

<p><strong>主程序main.cpp</strong></p>

<pre><code>#include “Dictionary.h”
# define MaxWordLength 10 // 最大词长为个字节（即个汉字）
# define Separator “/ ” // 词界标记
CDictionary WordDic; //初始化一个词典
//对字符串用最大匹配法（正向或逆向）处理
string SegmentSentence(string s1)
{
    string s2 = “”; //用s2存放分词结果
    while(!s1.empty())
    {
        int len =(int) s1.length(); // 取输入串长度
        if (len &gt; MaxWordLength) // 如果输入串长度大于最大词长
        {
            len = MaxWordLength; // 只在最大词长范围内进行处理
        }
        //string w = s1.substr(0, len); // （正向用）将输入串左边等于最大词长长度串取出作为候选词
        string w = s1.substr(s1.length() – len, len); //逆向用
        int n = WordDic.FindWord(w); // 在词典中查找相应的词
        while(len &gt; 2 &amp;&amp; n == 0) // 如果不是词
        {
            len -= 2; // 从候选词右边减掉一个汉字，将剩下的部分作为候选词
            //w = w.substr(0, len); //正向用
            w = s1.substr(s1.length() – len, len); //逆向用
            n = WordDic.FindWord(w);
        }
        //s2 += w + Separator; // (正向用）将匹配得到的词连同词界标记加到输出串末尾
        w = w + Separator; // (逆向用)
        s2 = w + s2 ; // (逆向用)
        //s1 = s1.substr(w.length(), s1.length()); //(正向用)从s1-w处开始
        s1 = s1.substr(0, s1.length() – len); // (逆向用)
    }
    return s2;
}
//对句子进行最大匹配法处理，包含对特殊字符的处理
string SegmentSentenceMM (string s1)
{
    string s2 = “”; //用s2存放分词结果
    int i;
    int dd;
    while(!s1.empty() )
    {
        unsigned char ch = (unsigned char)s1[0];
        if (ch &lt; 128) // 处理西文字符
        {
            i = 1;
            dd = (int)s1.length();
            while (i &lt; dd &amp;&amp; ((unsigned char)s1[i] &lt; 128) &amp;&amp; (s1[i] != 10) &amp;&amp; (s1[i] != 13)) // s1[i]不能是换行符或回车符
            {
                i++;
            }
            if ((ch != 32) &amp;&amp; (ch != 10) &amp;&amp; (ch != 13)) // 如果不是西文空格或换行或回车符
            {
                s2 += s1.substr(0,i) + Separator;
            }
            else
            {
                //if (ch == 10 || ch == 13) // 如果是换行或回车符，将它拷贝给s2输出
                if (ch == 10 || ch == 13 || ch == 32) //谢谢读者mces89的指正
                {
                    s2 += s1.substr(0, i);
                }
            }
            s1 = s1.substr(i,dd);
            continue;
        }
        else
        {
            if (ch &lt; 176) // 中文标点等非汉字字符
            {
                i = 0;
                dd = (int)s1.length();
                while(i &lt; dd &amp;&amp; ((unsigned char)s1[i] &lt; 176) &amp;&amp; ((unsigned char)s1[i] &gt;= 161)
                &amp;&amp; (!((unsigned char)s1[i] == 161 &amp;&amp; ((unsigned char)s1[i+1] &gt;= 162 &amp;&amp; (unsigned char)s1[i+1] &lt;= 168)))
                &amp;&amp; (!((unsigned char)s1[i] == 161 &amp;&amp; ((unsigned char)s1[i+1] &gt;= 171 &amp;&amp; (unsigned char)s1[i+1] &lt;= 191)))
                &amp;&amp; (!((unsigned char)s1[i] == 163 &amp;&amp; ((unsigned char)s1[i+1] == 172 || (unsigned char)s1[i+1] == 161)
                || (unsigned char)s1[i+1] == 168 || (unsigned char)s1[i+1] == 169 || (unsigned char)s1[i+1] == 186
                || (unsigned char)s1[i+1] == 187 || (unsigned char)s1[i+1] == 191)))
            {
                i = i + 2; // 假定没有半个汉字
            }
            if (i == 0)
            {
                i = i + 2;
            }
            if (!(ch == 161 &amp;&amp; (unsigned char)s1[1] == 161)) // 不处理中文空格
            {
                s2+=s1.substr(0, i) + Separator; // 其他的非汉字双字节字符可能连续输出
            }
            s1 = s1.substr(i, dd);
            continue;
            }
        }
        // 以下处理汉字串
        i = 2;
        dd = (int)s1.length();
        while(i &lt; dd &amp;&amp; (unsigned char)s1[i] &gt;= 176)
        {
            i += 2;
        }
        s2 += SegmentSentence(s1.substr(0, i));
        s1 = s1.substr(i,dd);
    }
    return s2;
}

int main(int argc, char *argv[])
{
    string strtmp; //用于保存从语料库中读入的每一行
    string line; //用于输出每一行的结果
    ifstream infile(argv[1]); // 打开输入文件
    if (!infile.is_open()) // 打开输入文件失败则退出程序
    {
        cerr &lt;&lt; "Unable to open input file: " &lt;&lt; argv[1]
&lt;&lt; " -- bailing out!" &lt;&lt; endl;
        exit(-1);
}
    ofstream outfile1("SegmentResult.txt"); //确定输出文件
    if (!outfile1.is_open())
    {
        cerr &lt;&lt; "Unable to open file：SegmentResult.txt"
&lt;&lt; "--bailing out!" &lt;&lt; endl;
        exit(-1);
    }
    while (getline(infile, strtmp, 'n')) //读入语料库中的每一行并用最大匹配法处理
    {
        line = strtmp;
        line = SegmentSentenceMM(line); // 调用分词函数进行分词处理
        outfile1 &lt;&lt; line &lt;&lt; endl; // 将分词结果写入目标文件
    }
    return 0;
}
</code></pre>

<p>补充说明：如果使用正向匹配法，请将源代码中的相关注释 “//"互换。</p>

                <nav class="pagination-link">
                    
                    <a class="prev" href="/2014/11/05/cn_cutwords.html" rel="bookmark">&laquo;&nbsp;中文分词：原理及分词算法</a>
                    
                    
                    <a class="next" href="/2014/11/16/HMM2.html" rel="bookmark">最大匹配算法扩展&nbsp;&raquo;</a>
                    
                 </nav>
			</article><!-- .entry -->		
		</div>
		<div class="aside fn-clear">
			<div class="box fn-clear">
	<img src="/images/psb.jpg" alt="about theme"/>
	<!-- modify by dianacody-->
	<ul>
		<li><b>I'M DianaCody</b></li>
		<li><i>dianacodyleaf@gmail.com</i></li>
		<li>DianaCody, a postgraduate student from BUPT. 1/2 coder, 1/2 writer. Love coding, writing and open-source, also reading and traveling sometimes.</li>
		<li>Interest Fields：Search Engine, Data Mining, Machine Learning, NLP. </li>
	</ul>
	
</div>
			<div class="box fn-clear">
	<h3 class="title">GitHub Project</h3>
	<ul>
		<li>&#8227;<a href="https://github.com/DianaCody/RecommandSystem/">Personal Recommand System</a></li>
		<li>&#8227;<a href="https://github.com/DianaCody/Spider_SinaTweetCrawler_java/">Spider SinaWeibo_Crawler</a></li>
		<li>&#8227;<a href="https://github.com/DianaCody/Spider_python/">Tweet Crawler</a></li>
		<li>&#8227;<a href="https://github.com/DianaCody/Translator/">Translator Plugin</a></li>
	</ul>
</div>
			<div class="box fn-clear">
	<h3 class="title">CSDN Blog</h3>
	<ul>
		<li><a href="http://blog.csdn.net/dianacody">http://blog.csdn.net/dianacody</a></li>
	</ul>

	<!--
	<p>This is a jekyll blog theme.</p>
	-->	
</div>
		</div>
	</div>
</section>
    </article>
  </section>
    <footer class="foot">
	<div class="foot-cnt fn-clear">
		<div class="foot-cnt-det fn-clear">
			<article class="blogroll">
				<h4 class="title">Links</h4>
				<ul>
					<li>&#8227;<a href="https://github.com/dianacody">DianaCody's Github</a></li>
					<li>&#8227;<a href="http://blog.csdn.net/dianacody">My csdn Blog</a></li>
					<!-- <li>&#8227;<a href="http://www.jekyllrb.com">www.jekyllrb.com</a></li> -->
				</ul>
			</article>
			<article class="about">
				<h4 class="title">About Me</h4>
				<p>DianaCody, a postgraduate student from BUPT. 1/2 coder, 1/2 writer. Love coding, writing and open-source, also reading and traveling sometimes.</p>
				<p>Interest Fields：Search Engine, Data Mining, Machine Learning, NLP. </p>
			</article>
			<article class="follow">
				<h4 class="title">Follow Me</h4>
				<ul>
					<li><a href="https://github.com/dianacody/" class="ico-github" target="_blank">github</a></li>
					<li><a href="/atom.xml" class="ico-rss" target="_blank">rss</a></li>
					<li><a href="http://www.linkedin.com/" class="ico-linkedin">linkedin</a></li>
					<li><a href="http://www.google.com/" class="ico-google">google</a></li>
					<li><a href="http://www.flickr.com/" class="ico-flickr">flickr</a></li>
					<li><a href="http://www.twitter.com/dianacody/" class="ico-twitter">twitter</a></li>
					<li><a href="http://www.facebook.com/" class="ico-facebook">facebook</a></li>
					<li><a href="http://www.vimeo.com/" class="ico-vimeo">vimeo</a></li>
				</ul>
			</article>
		</div>
	</div>
	<div class="foot-btn">
		<div class="foot-btn-det">
			<p class="copyright">© 2013-2015 DianaCody. All rights reserved.</p>
			<p class="author">Powered by <a href="http://www.jekyllrb.com">Jekyll</a>. Design by <a href="http://dianacody.github.io">DianaCody</a>.</p>
		</div>
	</div>
</footer>
</body>
</html>